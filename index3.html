<!DOCTYPE html>
<html lang="jp" dir="ltr">
<body>
  <h1>Great People</h1><hr>
  <div id="infiniteScrollId">
    <div>
      <h2>[ Name ]<br>Timothy "Tim" John Berners-Lee</h2>
      <h3>[ Gender ]<br>man</h3>
      <h3>[ Age ]<br>65</h3>
      <h3>[ Job ]<br>Computer scientist</h3><hr>
    </div>
    <div>
      <h2>[ Name ]<br>William Henry "Bill" Gates III</h2>
      <h3>[ Gender ]<br>man</h3>
      <h3>[ Age ]<br>64</h3>
      <h3>[ Job ]<br>Businessman</h3><hr>
    </div>
    <div>
      <h2>[ Name ]<br>Bjarne Stroustrup</h2>
      <h3>[ Gender ]<br>man</h3>
      <h3>[ Age ]<br>69</h3>
      <h3>[ Job ]<br>Computer scientist</h3><hr>
    </div>
    <div>
      <h2>[ Name ]<br>John Warner Backus</h2>
      <h3>[ Gender ]<br>man</h3>
      <h3>[ Age ]<br>82</h3>
      <h3>[ Job ]<br>Mathematician</h3><hr>
    </div>
  </div>

<script>
let url = `json.php`
let execution_flag = false

document.addEventListener('scroll', () => {
  try {
    let children = infiniteScrollId.children
    let {top, height} = children[children.length - 1].getBoundingClientRect()
    if (top + height <= window.innerHeight && !execution_flag) {
      execution_flag = true
      fetch(url)
      .then(response => response.text())
      .then(posts => {
        let tmp = ''
        JSON.parse(posts).forEach(post => {
          tmp += `
            <div style="color: blue;">
              <h2>[ Name ]<br>${post.name}</h2>
              <h3>[ Gender ]<br>${post.gender}</h3>
              <h3>[ Age ]<br>${post.age}</h3>
              <h3>[ Job ]<br>${post.job}</h3><hr>
            </div>
          `
        })
        infiniteScrollId.insertAdjacentHTML('beforeend', tmp)
        execution_flag = false
      })
      .catch(() => {e => console.error(e)})
    }
  } catch (e) {
    console.error(e)
  }
}, {passive: true})
</script>
</body>
</html>